(function(t){function e(e){for(var i,a,o=e[0],l=e[1],c=e[2],p=0,h=[];p<o.length;p++)a=o[p],n[a]&&h.push(n[a][0]),n[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],i=!0,o=1;o<r.length;o++){var l=r[o];0!==n[l]&&(i=!1)}i&&(s.splice(e--,1),t=a(a.s=r[0]))}return t}var i={},n={app:0},s=[];function a(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=i,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(r,i,function(e){return t[e]}.bind(null,i));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/static/pixel3d/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var i=r("64a9"),n=r.n(i);n.a},"04a6":function(t,e,r){"use strict";var i=r("86ea"),n=r.n(i);n.a},"0f90":function(t,e,r){},1949:function(t,e,r){},"23b4":function(t,e,r){"use strict";var i=r("f564"),n=r.n(i);n.a},5060:function(t,e,r){"use strict";var i=r("68ac"),n=r.n(i);n.a},"56d7":function(t,e,r){"use strict";r.r(e);var i,n=r("2b0e"),s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"w3-main",attrs:{id:"main-body"}},[r("header",{staticClass:"w3-bar w3-bottombar w3-border-theme",attrs:{id:"main-header"}},[r("button",{staticClass:"w3-bar-item w3-button w3-xlarge top-button w3-wide w3-text-red",class:["home"==t.currentTab?"w3-theme":""],on:{click:function(e){t.currentTab="home"}}},[t._v("\n\t\t\t\t\tUNIPIX\n\t\t\t\t")]),r("button",{staticClass:"w3-bar-item w3-button w3-xlarge top-button",class:["sprites"==t.currentTab?"w3-theme":""],on:{click:function(e){t.currentTab="sprites"}}},[t._v("\n\t\t\t\t\t\tGallery\n\t\t\t\t")]),r("button",{staticClass:"w3-bar-item w3-button w3-xlarge top-button",class:["editor"==t.currentTab?"w3-theme":""],attrs:{disabled:!t.currentSprite},on:{click:function(e){t.currentTab="editor"}}},[t._v("\n\t\t\t\t\t\tEditor\n\t\t\t\t")]),r("button",{staticClass:"w3-bar-item w3-button w3-xlarge top-button",class:["manual"==t.currentTab?"w3-theme":""],on:{click:function(e){t.currentTab="manual"}}},[t._v("\n\t\t\t\t\t\tManual\n\t\t\t\t")]),t._m(0),t._m(1),t._m(2)]),r("keep-alive",["home"==t.currentTab?r("home",{on:{"update:currentTab":function(e){t.currentTab=e}}}):t._e(),"sprites"==t.currentTab?r("sprites",{attrs:{sprites:t.sprites},on:{"edit-sprite":function(e){return t.editSprite(e)}}}):t._e(),"editor"==t.currentTab?r("editor",{attrs:{id:"editor",sprite:t.currentSprite}}):t._e()],1)],1)])},a=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a",{staticClass:"w3-bar-item w3-button w3-right  w3-xlarge top-button w3-hover-black",attrs:{href:"https://github.com/PaulBreugnot/UniPix"}},[r("i",{staticClass:"fa fa-github fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\tGitHub\n\t\t\t")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a",{staticClass:"w3-bar-item w3-button w3-right  w3-xlarge top-button w3-text-blue w3-hover-blue",attrs:{href:"https://twitter.com/PaulBreugnot"}},[r("i",{staticClass:"fa fa-twitter fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\tTwitter\n\t\t\t")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a",{staticClass:"w3-bar-item w3-button w3-right  w3-xlarge top-button w3-text-deep-purple w3-hover-deep-purple",attrs:{href:"https://join.slack.com/t/pixled/shared_invite/enQtNjYwMDczNTg3Mjk2LTJiMjZkMzhiZjgzYmVjNTgxZWViYmU3NjYzOWUzMWU5ZTQ4YmMyZjRiMzRjNjAxMjcxZTkwMTQyMmNkM2RmODM"}},[r("i",{staticClass:"fa fa-slack",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\tSlack\n\t\t\t")])}],o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-container"},[t._m(0),r("div",{staticClass:"w3-container w3-center",attrs:{id:"home-content"}},[t._m(1),t._m(2),r("p",[t._v("\n\t\t\tNo 3D modelling skills are required to build your models : the algorithm handles a base\n\t\t\tmodel generation for you, that you can edit and customize simply by changing color\n\t\t\theights from the editor. You can then export your model as an .stl file, ready to load\n\t\t\tin your favourite 3D slicer.\n\t\t")]),t._m(3),r("div",{staticClass:"w3-container w3-margin-top"},[r("button",{staticClass:"w3-button w3-blue w3-xxlarge w3-round-large",on:{click:function(e){return t.$emit("update:currentTab","sprites")}}},[t._v("Start Building Your Sprites!")])])])])},l=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("h1",{staticClass:"w3-center",attrs:{id:"home-title"}},[r("b",[t._v("Welcome to UNIPIX 1.0!")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[r("b",{staticClass:"w3-wide w3-text-red"},[t._v("UNIPIX")]),t._v(" is a Web Application that allows you to easily generate 3D models\n\t\t\tfrom your favourite retro game sprites and pixel arts.\n\t\t")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-container w3-center"},[r("img",{staticClass:"w3-margin-right",attrs:{src:"kirby_2d.png",height:"200px"}}),r("img",{staticClass:"w3-margin-left",attrs:{src:"kirby_3d.png",height:"200px"}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-cell-row w3-padding-16 w3-center"},[r("div",{staticClass:"w3-cell w3-mobile"},[r("h3",[r("b",[t._v("1. Choose a sprite")])]),r("img",{attrs:{src:"vile_2d.png",height:"300px"}})]),r("div",{staticClass:"w3-cell w3-mobile"},[r("h3",[r("b",[t._v("2. Import it and build your model")])]),r("img",{attrs:{src:"vile_3d.png",height:"300px"}})]),r("div",{staticClass:"w3-cell w3-mobile"},[r("h3",[r("b",[t._v("3. Print it!")])]),r("img",{attrs:{src:"vile_print.JPG",height:"300px"}})]),r("div",{staticClass:"w3-cell w3-mobile"},[r("h3",[r("b",[t._v("4. (Optional) Paint it!")])]),r("img",{attrs:{src:"vile_paint.png",height:"300px"}})])])}],c=(r("83c2"),r("2877")),u={},p=Object(c["a"])(u,o,l,!1,null,null,null),h=p.exports,d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.selectedSprite?r("delete-sprite",{attrs:{sprite:t.selectedSprite,display:t.showConfirmDelete},on:{"hide-delete":t.hideDelete,"delete-sprite":t.deleteSprite}}):t._e(),r("new-sprite",{attrs:{display:t.displayNewSprite},on:{"new-sprite":t.addNewSprite,"update:display":function(e){t.displayNewSprite=e}}}),r("button",{staticClass:"w3-button w3-xlarge w3-round-large w3-margin-left w3-margin-top w3-blue",on:{click:function(e){t.displayNewSprite=!0}}},[r("i",{staticClass:"fa fa-upload fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\tUpload New Sprite\n\t")]),r("div",{staticClass:"w3-row-padding"},t._l(t.sprites,function(e){return r("div",{staticClass:"w3-col l4 m6 s12 w3-padding-16"},[r("sprite",{attrs:{sprite:e},on:{"confirm-delete":t.confirmDelete,"edit-sprite":function(e){return t.$emit("edit-sprite",e)}}})],1)}),0)],1)},f=[],m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.sprite?r("div",{staticClass:"w3-card"},[t.renaming?r("header",{staticClass:"w3-cell-row w3-theme-d1"},[r("div",{staticClass:"w3-container w3-cell w3-cell-middle"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.sprite.name,expression:"sprite.name"}],staticClass:"w3-input w3-theme-l1 w3-border-0",attrs:{type:"text"},domProps:{value:t.sprite.name},on:{input:function(e){e.target.composing||t.$set(t.sprite,"name",e.target.value)}}})]),r("div",{staticClass:"w3-container w3-cell w3-cell-middle"},[r("button",{staticClass:"w3-button w3-right w3-hover-theme w3-theme-l1",on:{click:function(e){return t.renameSprite()}}},[t._v("OK")])])]):r("header",{staticClass:"w3-cell-row w3-padding w3-theme-d1"},[t.displayTools?r("div",{staticClass:"w3-dropdown-hover w3-cell w3-cell-middle w3-theme-d1"},[r("i",{staticClass:"fa fa-bars fa-2x",attrs:{"aria-hidden":"true"}}),r("div",{staticClass:"w3-dropdown-content w3-bar-block w3-border"},[r("button",{staticClass:"w3-bar-item w3-button",on:{click:function(e){return t.renamimgMode()}}},[r("i",{staticClass:"fa fa-pencil",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\tRename\n\t\t\t\t")]),r("button",{staticClass:"w3-bar-item w3-button w3-text-red",on:{click:function(e){return t.$emit("confirm-delete",t.sprite)}}},[r("i",{staticClass:"fa fa-trash-o",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\tDelete\n\t\t\t\t")]),r("button",{staticClass:"w3-bar-item w3-button",on:{click:function(e){return t.$emit("edit-sprite",t.sprite)}}},[r("i",{staticClass:"fa fa-cubes",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t\tEdit Model\t\n\t\t\t\t")])])]):t._e(),r("div",{staticClass:"w3-container w3-cell w3-cell-middle"},[r("h4",[t._v(t._s(t.sprite.name))])]),r("div",{staticClass:"w3-cell w3-cell-middle w3-right"},[t.displayTools?r("button",{staticClass:"w3-bar-item w3-button w3-large w3-blue w3-round-large",on:{click:function(e){return t.$emit("edit-sprite",t.sprite)}}},[r("i",{staticClass:"fa fa-cubes",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\tEdit Model\t\n\t\t")]):t._e()])]),r("div",{staticClass:"w3-row w3-center"},[r("button",{staticClass:"w3-button w3-bottombar w3-border-theme w3-hover-theme w3-half",class:["sprite-2d"==t.currentTab?"w3-theme-d1":""],on:{click:function(e){t.currentTab="sprite-2d"}}},[t._v("\n\t\t\t2D Sprite\n\t\t")]),r("button",{staticClass:"w3-button w3-bottombar w3-border-theme w3-hover-theme w3-half",class:["sprite-3d"==t.currentTab?"w3-theme-d1":""],on:{click:function(e){t.currentTab="sprite-3d"}}},[t._v("\n\t\t\t3D Model\n\t\t")])]),r("div",{staticClass:"sprite-view w3-padding-16 w3-center"},[r("keep-alive",["sprite-2d"==t.currentTab?r("sprite-2d",{attrs:{sprite:t.sprite}}):t._e(),"sprite-3d"==t.currentTab&&t.sprite.colorMap?r("sprite-3d",{attrs:{sprite:t.sprite,animate:""}}):t._e()],1),"sprite-3d"!=t.currentTab||t.sprite.colorMap?t._e():r("process-sprite",{attrs:{sprite:t.sprite},on:{"sprite-process":t.handleSpriteProcess}})],1)]):t._e()},w=[],b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("svg",{staticClass:"sprite-svg",attrs:{viewBox:t.viewBoxSize}},t._l(t.sprite.pixelMap.rows,function(e,i){return r("g",t._l(e,function(e,n){return r("g",[r("rect",{style:{fill:t.computeColor(e)},attrs:{x:10*n,y:10*i,width:"10",height:"10"}})])}),0)}),0)},g=[],v={props:["sprite"],computed:{viewBoxSize:function(){var t,e,r,i,n;return e=10*this.sprite.pixelMap.height,r=10*this.sprite.pixelMap.width,n=Math.max(e,r),t=(r-n)/2,i=(e-n)/2,`${t} ${i} ${n} ${n}`}},methods:{computeColor:function(t){return`rgb(${t.r},${t.g},${t.b})`}},mounted:function(){return console.log(this.sprite)}},_=v,C=(r("23b4"),Object(c["a"])(_,b,g,!1,null,null,null)),x=C.exports,M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("canvas",{ref:t.canvasName,staticClass:"sprite-canvas"})},y=[],$=r("633b");r("b234");i=function(t,e){var r;return r=new $["Scene"](t),r};var S={props:{sprite:{type:Object,required:!0},animate:{type:Boolean,default:!1}},data:function(){return{centerNode:null,engine:null,scene:null,camera:null,meshes:{},highlightLayer:null,highlightedMeshes:[]}},watch:{sprite:function(t,e){return this.$nextTick(function(){return this.clear(),this.initBuild(),this.build(),this.run()})}},computed:{canvasName:function(){return`canvas_${this.sprite.id}`}},methods:{lookForPixelHeightInColorMap:function(t){var e,r,i,n,s;for(r=0,s=this.sprite.colorMap.colorMapItems,i=0,n=s.length;i<n;i++)e=s[i],function(e){e.r===t.r&&e.g===t.g&&e.b===t.b&&(r=e.h)}(e);return r},buildPixel:function(t,e,r,i){var n,s;return[new $["Vector2"](0,0),new $["Vector2"](1,0),new $["Vector2"](1,1),new $["Vector2"](0,1)],n=this.lookForPixelHeightInColorMap(r),s={width:this.sprite.colorMap.pixelSize,height:this.sprite.colorMap.pixelSize,depth:1,updatable:!0},r=$["MeshBuilder"].CreateBox(`pixel_${t}_${e}`,s,i),r.scaling.z=n,r.position.y=(this.sprite.pixelMap.height-t)*this.sprite.colorMap.pixelSize,r.position.x=e*this.sprite.colorMap.pixelSize,r.position.z=-n/2,r.setParent(this.centerNode),r},buildCamera:function(){var t,e;return e=Math.max(this.sprite.pixelMap.width*this.sprite.colorMap.pixelSize,this.sprite.pixelMap.height*this.sprite.colorMap.pixelSize+10),t=new $["ArcRotateCamera"]("camera",-Math.PI/2,Math.PI/2,e,this.centerNode.position,this.scene),t},refreshCamera:function(){var t,e,r,i,n,s;for(this.camera.setTarget(this.centerNode.position),n=Math.max(this.sprite.pixelMap.width*this.sprite.colorMap.pixelSize,this.sprite.pixelMap.height*this.sprite.colorMap.pixelSize+10),this.camera.radius=n,t=[],s=Object.values(this.meshes),e=0,r=s.length;e<r;e++)i=s[e],function(e){var r,i,n,s,a;for(s=Object.values(e),a=[],r=0,i=s.length;r<i;r++)n=s[r],a.push(t.push(n))}(i);return this.camera.zoomOn(t)},buildLight:function(){return new $["HemisphericLight"]("light1",new $["Vector3"](1,0,0),this.scene)},animateSprite:function(){var t,e;return e=new BABYLON.Animation("myAnimation","rotation.y",30,$["Animation"].ANIMATIONTYPE_FLOAT,$["Animation"].ANIMATIONLOOPMODE_CYCLE),t=[],t.push({frame:0,value:0}),t.push({frame:150,value:2*Math.PI}),e.setKeys(t),this.centerNode.animations=[],this.centerNode.animations.push(e),this.scene.beginAnimation(this.centerNode,0,150,!0)},getMeshes:function(){return this.meshes},highlightMeshes:function(t){var e,r,i,n,s,a,o,l;for(a=this.highlightedMeshes,e=0,i=a.length;e<i;e++)s=a[e],this.highlightLayer.removeMesh(s);for(l=this,o=[],r=0,n=t.length;r<n;r++)s=t[r],o.push(function(t){return l.highlightedMeshes.push(t),l.highlightLayer.addMesh(t,$["Color3"].Blue())}(s));return o},updateMeshes:function(t,e){var r,i,n,s;for(s=[],r=0,i=t.length;r<i;r++)n=t[r],s.push(function(t){return t.scaling.z=e,t.position.z=-e/2}(n));return s},build:function(){var t,e,r,i,n,s,a,o,l;for(this.clear(),l=this,console.log("Removing current meshes..."),s=Object.values(this.meshes),e=0,r=s.length;e<r;e++)n=s[e],function(t){var e,r,i,n,s;for(n=Object.values(t),s=[],e=0,r=n.length;e<r;e++)i=n[e],s.push(l.scene.removeMesh(i))}(n);for(i in console.log("Computing center node..."),t=function(t,e,r){var i,n;return i=l.buildPixel(t,e,r,l.scene),n=new $["StandardMaterial"](`pixel_${t}_${e}_texture`,l.scene),n.diffuseColor=new $["Color3"](r.r/255,r.g/255,r.b/255),i.material=n,l.meshes[t]||(l.meshes[t]={}),l.meshes[t][e]=i},console.log("Building pixels..."),a=this.sprite.pixelMap.rows,a)o=a[i],function(e,r){var i,n,s;for(i in s=[],r)n=r[i],s.push(function(r,i){return t(e,r,i)}(i,n))}(i,o);if(this.refreshCamera(),this.animate)return this.animateSprite()},initBuild:function(){var t,e;return t=this.$refs[this.canvasName],this.engine=new $["Engine"](t,!0,{stencil:!0}),this.scene=i(this.engine,t),this.centerNode=new $["TransformNode"]("center",this.scene),this.centerNode.setAbsolutePosition(new $["Vector3"](this.sprite.pixelMap.width*this.sprite.colorMap.pixelSize/2,this.sprite.pixelMap.height*this.sprite.colorMap.pixelSize/2,0)),this.centerNode.rotation.z=-Math.PI/2,this.camera=this.buildCamera(),this.camera.attachControl(t,!1),this.buildLight(),this.highlightLayer=new $["HighlightLayer"]("hl",this.scene),this.highlightLayer.blurHorizontalSize=.1,this.highlightLayer.blurVerticalSize=.5,e=this,window.addEventListener("resize",function(){return e.engine.resize()})},clear:function(){return this.engine.stopRenderLoop()},run:function(){var t;return t=this,this.engine.runRenderLoop(function(){return t.scene.render()})}},mounted:function(){return this.initBuild(),this.build()},destroyed:function(){return this.clear()},deactivated:function(){return this.clear()},activated:function(){return this.run()}},k=S,N=(r("04a6"),Object(c["a"])(k,M,y,!1,null,null,null)),T=N.exports,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-display-container",attrs:{id:"processContainer"}},[r("button",{staticClass:"w3-button w3-theme w3-display-middle w3-xlarge",on:{click:function(e){return t.processSprite()}}},[r("i",{staticClass:"fa fa-cogs fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n    Generate Model\n  ")])])},O=[],z={props:{sprite:{type:Object,required:!0}},methods:{processSprite:function(){var t,e,r;return r="/api/sprites/"+this.sprite.id+"/process/",t={method:"PUT"},e=this,fetch(r,t).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return e.$emit("sprite-process",e.sprite,t)})}}},P=z,E=(r("72e1"),Object(c["a"])(P,j,O,!1,null,null,null)),D=E.exports,I={props:{sprite:{type:Object,required:!0},displayTools:{type:Boolean,required:!1,default:!0}},components:{"sprite-2d":x,"sprite-3d":T,"process-sprite":D},data:function(){return{renaming:!1,currentTab:"sprite-2d"}},methods:{renamimgMode:function(){return this.renaming=!0},renameSprite:function(){var t,e,r;return r=`http://localhost:8000/api/sprites/${this.sprite.id}/`,t={method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({name:`${this.sprite.name}`})},e=this,fetch(r,t).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return e.sprite.name=t.name,e.renaming=!1})},handleSpriteProcess:function(t,e){return console.log(e),t.colorMap=e.colorMap}}},H=I,B=(r("ee71"),Object(c["a"])(H,m,w,!1,null,null,null)),L=B.exports,U=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-modal",style:{display:t.modalDisplay}},[r("div",{staticClass:"w3-modal-content"},[r("header",{staticClass:"w3-theme w3-bar"},[r("h3",{staticClass:"w3-bar-item"},[t._v("Upload new sprite")]),r("button",{staticClass:"w3-button w3-bar-item w3-right w3-theme",on:{click:function(e){return t.$emit("update:display",!1)}}},[r("i",{staticClass:"fa fa-times fa-lg"})])]),r("div",{staticClass:"w3-container w3-margin w3-animate-opacity w3-animate-zoom w3-padding-16"},[t._m(0),r("input",{directives:[{name:"model",rawName:"v-model",value:t.spriteName,expression:"spriteName"}],staticClass:"w3-input w3-border w3-light-grey",attrs:{type:"text"},domProps:{value:t.spriteName},on:{input:function(e){e.target.composing||(t.spriteName=e.target.value)}}}),r("div",{staticClass:"w3-margin-top"},[t._m(1),r("input",{staticClass:"w3-input w3-border-0",attrs:{type:"file"},on:{change:t.selectFile}})]),r("div",{staticClass:"w3-margin-top"},[r("div",{staticClass:"w3-cell"},[r("button",{staticClass:"w3-btn w3-theme",attrs:{disabled:t.processing},on:{click:function(e){return t.uploadNewSprite()}}},[t.processing?r("span",[t._v("\n\t\t\t\t\tprocessing...\n\t\t\t\t\t")]):r("span",[t._v("\n\t\t\t\t\tUpload!\n\t\t\t\t\t")])])]),t.processing?r("div",{staticClass:"w3-cell"},[r("i",{staticClass:"fa fa-circle-o-notch fa-spin fa-lg fa-fw"})]):t._e()])])])])},A=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("label",{staticClass:"w3-text-theme"},[r("b",[t._v("Sprite Name")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("label",{staticClass:"w3-text-theme w3-margin-top"},[r("b",[t._v("Select File")])])}],F={props:{display:{type:Boolean,required:!0}},data:function(){return{showNewSprite:!1,selectedFile:null,spriteName:"",processing:!1}},computed:{modalDisplay:function(){return this.display?"block":"none"}},methods:{selectFile:function(t){var e;return this.selectedFile=t.target.files[0],e=/(\w+)\.\w+$/,e.test(this.selectedFile.name)?this.spriteName=e.exec(this.selectedFile.name)[1]:this.spriteName=this.selectedFile.name,console.log(this.spriteName)},uploadNewSprite:function(){var t,e,r,i;return this.processing=!0,i="http://localhost:8000/api/sprites/",t=new FormData,t.append("name",this.spriteName),t.append("sprite",this.selectedFile),e={method:"POST",body:t},r=this,fetch(i,e).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return r.processing=!1,console.log(t),r.processSprite(t.id),r.$emit("update:display",!1)})},processSprite:function(t){var e,r,i;return i=`http://localhost:8000/api/sprites/${t}/process/`,e={method:"PUT"},r=this,fetch(i,e).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return console.log(t),r.$emit("new-sprite",t)})}}},R=F,Y=Object(c["a"])(R,U,A,!1,null,null,null),q=Y.exports,V=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-modal",class:[t.display?"w3-show":"w3-hide"]},[r("div",{staticClass:"w3-modal-content"},[t._m(0),r("div",{staticClass:"w3-container w3-center w3-row-padding"},[r("div",{staticClass:"w3-col l4 m3 s0 w3-padding-16"}),r("div",{staticClass:"w3-col l4 m6 s12 w3-padding-16"},[r("sprite",{attrs:{sprite:t.sprite,"display-tools":!1}})],1),r("div",{staticClass:"w3-col l4 m3 s0 w3-padding-16"})]),r("footer",{staticClass:"w3-container w3-cell-row w3-center"},[r("button",{staticClass:"w3-button w3-theme w3-xlarge w3-cell w3-margin",on:{click:function(e){return t.$emit("hide-delete")}}},[t._v("Cancel")]),r("button",{staticClass:"w3-button w3-red w3-xlarge w3-cell w3-margin",on:{click:function(e){return t.deleteSprite()}}},[t._v("Delete")])])])])},J=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("header",{staticClass:"w3-container w3-center w3-theme-l1"},[r("h3",[t._v("Do you really want to delete this sprite?")])])}],W={props:["display","sprite"],components:{sprite:L},methods:{deleteSprite:function(){var t,e,r;return r=`http://localhost:8000/api/sprites/${this.sprite.id}/`,t={method:"DELETE"},e=this,fetch(r,t).catch(function(t){return console.log(t)}).then(function(t){return e.$emit("delete-sprite",e.sprite)})}}},Z=W,G=Object(c["a"])(Z,V,J,!1,null,null,null),Q=G.exports,X={components:{sprite:L,"new-sprite":q,"delete-sprite":Q},props:{sprites:{type:Array,required:!0}},data:function(){return{selectedSprite:null,displayNewSprite:!1,showConfirmDelete:!1}},methods:{confirmDelete:function(t){return this.selectedSprite=t,this.showConfirmDelete=!0},hideDelete:function(){return this.showConfirmDelete=!1},deleteSprite:function(t){var e,r;e=!1,r=0;while(!e)this.sprites[r].id===t.id&&(this.sprites.splice(r,1),e=!0),r++;return this.hideDelete()},addNewSprite:function(t){return this.sprites.unshift(t)}}},K=X,tt=Object(c["a"])(K,d,f,!1,null,null,null),et=tt.exports,rt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("toolbar",{attrs:{updates:t.updates,sprite:t.sprite,id:"editor-toolbar"},on:{reprocess:t.refresh3Ddisplay}}),r("div",{staticClass:"w3-cell-row",attrs:{id:"editor-body"}},[r("div",{staticClass:"w3-cell",attrs:{id:"sprite-view"}},[r("sprite-3d",{ref:"sprite3d",attrs:{sprite:t.sprite}})],1),r("div",{staticClass:"w3-cell w3-cell-top w3-bar-block w3-center",staticStyle:{width:"20%"}},[r("h3",{staticClass:"w3-bar-item w3-center w3-border-top w3-border-theme",attrs:{id:"size-title"}},[t._v("Size")]),r("form",{staticClass:"w3-container"},[t._m(0),r("input",{directives:[{name:"model",rawName:"v-model",value:t.sprite.colorMap.pixelSize,expression:"sprite.colorMap.pixelSize"}],staticClass:"w3-input w3-border",attrs:{type:"number"},domProps:{value:t.sprite.colorMap.pixelSize},on:{input:[function(e){e.target.composing||t.$set(t.sprite.colorMap,"pixelSize",e.target.value)},function(e){return t.handlePixelSizeInput(e.target.value)}]}}),t._m(1),r("input",{directives:[{name:"model",rawName:"v-model",value:t.sprite.colorMap.maxHeight,expression:"sprite.colorMap.maxHeight"}],staticClass:"w3-input w3-border",attrs:{type:"number"},domProps:{value:t.sprite.colorMap.maxHeight},on:{input:[function(e){e.target.composing||t.$set(t.sprite.colorMap,"maxHeight",e.target.value)},function(e){return t.handleMaxHeightInput(e.target.value)}]}})]),r("table",{staticClass:"w3-table"},[t._m(2),r("tr",[r("td",[t._v(" "+t._s(t.sprite.pixelMap.height*t.sprite.colorMap.pixelSize))]),r("td",[t._v(" "+t._s(t.sprite.pixelMap.width*t.sprite.colorMap.pixelSize))]),r("td",[t._v(" "+t._s(t.maxHeight))])])]),r("h3",{staticClass:"w3-bar-item w3-center w3-border-top w3-border-theme"},[t._v("ColorMap")]),r("color-map",{staticClass:"color-map",attrs:{"color-map":t.sprite.colorMap},on:{"select-color":function(e){return t.selectMeshes(e)},"update-color":function(e){return t.handleUpdateColor(e)}}})],1)])],1)},it=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("label",{staticClass:"w3-text-theme"},[r("b",[t._v("Pixel Size")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("label",{staticClass:"w3-text-theme"},[r("b",[t._v("Max Height")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("th",[t._v("Height")]),r("th",[t._v("Width")]),r("th",[t._v("Height")])])}],nt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-bar w3-theme-l4"},[r("button",{staticClass:"w3-button w3-bar-item toolbar-button w3-large",attrs:{disabled:!t.currentlyUpdating},on:{click:t.save}},[r("i",{staticClass:"fa fa-floppy-o fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\tSave\n\t\t")]),r("button",{staticClass:"w3-button w3-bar-item toolbar-button w3-large",on:{click:t.exportSprite}},[r("i",{staticClass:"fa fa-rocket fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\tDownload STL\t\n\t\t")]),r("button",{staticClass:"w3-button w3-bar-item w3-border-right w3-border-theme toolbar-button w3-large",on:{click:t.processSprite}},[r("i",{staticClass:"fa fa-refresh fa-lg",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\tRe-build\t\n\t\t")])])},st=[],at=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-dropdown-click"},[r("button",{staticClass:"w3-button",on:{click:function(e){return t.toggle()}}},[r("i",{staticClass:"fa fa-angle-down",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t"+t._s(t.selectedMethod)+"\n\t")]),r("div",{staticClass:"w3-dropdown-content w3-bar-block w3-border",class:[t.show?"w3-show":"w3-hide"],attrs:{id:"Demo"}},t._l(t.methods,function(e){return r("button",{staticClass:"w3-bar-item w3-button"},[t._v(t._s(e))])}),0)])},ot=[],lt={data:function(){return{methods:["default","hue"],selectedMethod:"default",show:!1}},methods:{toggle:function(){return this.show=!this.show}}},ct=lt,ut=Object(c["a"])(ct,at,ot,!1,null,null,null),pt=ut.exports,ht=r("a217"),dt=r.n(ht),ft={components:{methods:pt},computed:{currentlyUpdating:function(){return Object.keys(this.updates.colorMapItems).length||this.updates.maxHeight||this.updates.pixelSize}},props:{sprite:{type:Object,required:!0},updates:{type:Object,required:!0}},methods:{save:function(){var t,e,r;return console.log(this.updatedColorItems),r=`/api/color_maps/${this.sprite.colorMap.id}/`,t={method:"PATCH",body:JSON.stringify(this.updates),headers:{"Content-Type":"application/json"}},console.log(t.body),e=this,fetch(r,t).catch(function(t){return console.log(t)}).then(function(t){return console.log(t),e.updates.colorMapItems=[],e.$delete(e.updates,"maxHeight"),e.$delete(e.updates,"pixelSize")})},processSprite:function(){var t,e,r;return r="/api/sprites/"+this.sprite.id+"/process/",t={method:"PUT"},e=this,fetch(r,t).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return e.sprite.colorMap=t.colorMap,console.log(e.sprite),e.$emit("reprocess")})},exportSprite:function(){var t,e;return e="/api/sprites/"+this.sprite.id+"/export/",t={method:"PUT"},this,fetch(e,t).catch(function(t){return console.log(t)}).then(function(t){return t.json()}).then(function(t){return console.log(t),dt()(`${t.model3d}`,`${t.name}.stl`,"application/octet-stream")})}}},mt=ft,wt=(r("5060"),Object(c["a"])(mt,nt,st,!1,null,null,null)),bt=wt.exports,gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-dropdown-click"},[r("button",{staticClass:"w3-button w3-theme",on:{click:function(e){return t.toggle()}}},[r("i",{staticClass:"fa fa-angle-down",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\tSelect profile\n\t")]),r("div",{staticClass:"w3-dropdown-content w3-bar-block w3-border",class:[t.show?"w3-show":"w3-hide"],attrs:{id:"Demo"}},t._l(t.profiles,function(e){return r("button",{staticClass:"w3-bar-item w3-button"},[t._v(t._s(e))])}),0)])},vt=[],_t={data:function(){return{profiles:["default"],show:!1}},methods:{toggle:function(){return this.show=!this.show}}},Ct=_t,xt=Object(c["a"])(Ct,gt,vt,!1,null,null,null),Mt=xt.exports,yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w3-container w3-center"},[r("div",{staticClass:"color-map-table"},[r("table",{staticClass:"w3-table w3-centered w3-hoverable w3-border w3-bordered"},[t._m(0),r("tbody",t._l(t.colorMap.colorMapItems,function(e){return r("color-item",{ref:t.colorRef(e),refInFor:!0,class:[t.selectedColor==t.colorRef(e)?"w3-theme":""],attrs:{color:e},on:{"update-color":function(e){return t.updateColor(e)},click:function(r){return t.selectColor(e)}}})}),1)])])])},$t=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",[t._v("Color")]),r("th",[t._v("R")]),r("th",[t._v("G")]),r("th",[t._v("B")]),r("th",[t._v("Height")])])])}],St=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",{on:{click:function(e){return t.$emit("click")}}},[r("td",{style:t.computeColor(t.color)}),r("td",[t._v(" "+t._s(t.color.r)+" ")]),r("td",[t._v(" "+t._s(t.color.g)+" ")]),r("td",[t._v(" "+t._s(t.color.b)+" ")]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.color.h,expression:"color.h",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.color.h},on:{input:[function(e){e.target.composing||t.$set(t.color,"h",t._n(e.target.value))},t.updateColor],blur:function(e){return t.$forceUpdate()}}})])])},kt=[],Nt={props:["color"],methods:{computeColor:function(t){return{"background-color":`rgb(${t.r},${t.g},${t.b})`}},updateColor:function(t){return this.$emit("update-color",this.color)}}},Tt=Nt,jt=Object(c["a"])(Tt,St,kt,!1,null,null,null),Ot=jt.exports,zt={components:{"color-item":Ot},props:["colorMap"],data:function(){return{selectedColor:null}},methods:{colorRef:function(t){return`${t.r},${t.g},${t.b}`},selectColor:function(t){return this.$emit("select-color",t),this.selectedColor=this.colorRef(t)},updateColor:function(t){return this.$emit("update-color",t)}}},Pt=zt,Et=(r("805c"),Object(c["a"])(Pt,yt,$t,!1,null,null,null)),Dt=Et.exports,It={components:{toolbar:bt,"sprite-3d":T,methods:pt,profiles:Mt,"color-map":Dt},props:["sprite"],data:function(){return{updates:{colorMapItems:[]}}},computed:{maxHeight:function(){var t,e,r,i,n;for(i=0,n=this.sprite.colorMap.colorMapItems,t=0,r=n.length;t<r;t++)e=n[t],function(t){if(t.h>i)i=t.h}(e);return i}},methods:{findMeshes:function(t){var e,r,i,n,s,a;for(e in s=[],r=this.$refs.sprite3d.getMeshes(),a=this,i=a.sprite.pixelMap.rows,i)n=i[e],function(e,i){var n,a,o;for(n in o=[],i)a=i[n],o.push(function(i,n){if(n.r===t.r&&n.g===t.g&&n.b===t.b)return s.push(r[e][i])}(n,a))}(e,n);return s},selectMeshes:function(t){return this.$refs.sprite3d.highlightMeshes(this.findMeshes(t))},updateMeshes:function(t){return this.$refs.sprite3d.updateMeshes(this.findMeshes(t),t.h)},handleUpdateColor:function(t){var e,r,i,n,s;for(this.updateMeshes(t),s=this.updates.colorMapItems,i=0,n=s.length;i<n;i++)e=s[i],e.id===t.id&&(r=e);return r?r.h=t.h:this.updates.colorMapItems.push(t)},handlePixelSizeInput:function(t){return this.$set(this.updates,"pixelSize",t),this.refresh3Ddisplay()},handleMaxHeightInput:function(t){return this.$set(this.updates,"maxHeight",t)},refresh3Ddisplay:function(){return this.$refs.sprite3d.clear(),this.$refs.sprite3d.build(),this.$refs.sprite3d.run()}}},Ht=It,Bt=(r("e8d7"),Object(c["a"])(Ht,rt,it,!1,null,null,null)),Lt=Bt.exports,Ut={components:{home:h,sprites:et,editor:Lt},data:function(){return{sprites:[],sideBarDisplay:"block",currentTab:"home",currentSprite:null}},methods:{selectTab:function(t){return this.currentTab=t},editSprite:function(t){return this.currentSprite=t,this.currentTab="editor"},fetchSprites:function(){var t,e;return e="http://localhost:8000/api/sprites/",{headers:{accept:"application/json"}},t=this,fetch(e).catch(function(t){return console.log(t)}).then(function(t){return console.log(t),t.json()}).then(function(e){return console.log(e),t.sprites=e})}},mounted:function(){return this.fetchSprites()}},At=Ut,Ft=(r("034f"),Object(c["a"])(At,s,a,!1,null,null,null)),Rt=Ft.exports;n["a"].config.productionTip=!1,new n["a"]({render:t=>t(Rt)}).$mount("#app")},"64a9":function(t,e,r){},"68ac":function(t,e,r){},"72e1":function(t,e,r){"use strict";var i=r("fc56"),n=r.n(i);n.a},7307:function(t,e,r){},"805c":function(t,e,r){"use strict";var i=r("d7a7"),n=r.n(i);n.a},"83c2":function(t,e,r){"use strict";var i=r("7307"),n=r.n(i);n.a},"86ea":function(t,e,r){},d7a7:function(t,e,r){},e8d7:function(t,e,r){"use strict";var i=r("0f90"),n=r.n(i);n.a},ee71:function(t,e,r){"use strict";var i=r("1949"),n=r.n(i);n.a},f564:function(t,e,r){},fc56:function(t,e,r){}});
//# sourceMappingURL=app.20f26667.js.map